!function(){function t(t,e){"use strict";var n={version:"1.7.3",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};return n.chartRegistry=function(){function t(t){return t||(t=n.constants.DEFAULT_CHART_GROUP),e[t]||(e[t]=[]),t}var e={};return{has:function(t){for(var n in e)if(e[n].indexOf(t)>=0)return!0;return!1},register:function(n,r){r=t(r),e[r].push(n)},clear:function(){e={}},list:function(n){return n=t(n),e[n]}}}(),n.registerChart=function(t,e){n.chartRegistry.register(t,e)},n.hasChart=function(t){return n.chartRegistry.has(t)},n.deregisterAllCharts=function(){n.chartRegistry.clear()},n.filterAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].filterAll()},n.renderAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].render();null!==n._renderlet&&n._renderlet(t)},n.redrawAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].redraw();null!==n._renderlet&&n._renderlet(t)},n.transition=function(t,e,n){if(0>=e||void 0===e)return t;var r=t.transition().duration(e);return n instanceof Function&&n(r),r},n.units={},n.units.integers=function(t,e){return Math.abs(e-t)},n.units.ordinal=function(t,e,n){return n},n.units.fp={},n.units.fp.precision=function(t){var e=function(t,r){var i=Math.abs((r-t)/e.resolution);return n.utils.isNegligible(i-Math.floor(i))?Math.floor(i):Math.ceil(i)};return e.resolution=t,e},n.round={},n.round.floor=function(t){return Math.floor(t)},n.round.ceil=function(t){return Math.ceil(t)},n.round.round=function(t){return Math.round(t)},n.override=function(t,e,n){var r=t[e];t["_"+e]=r,t[e]=n},n.renderlet=function(t){return arguments.length?(n._renderlet=t,n):n._renderlet},n.instanceOfChart=function(t){return t instanceof Object&&t.__dc_flag__},n.errors={},n.errors.Exception=function(t){var e=void 0!==t?t:"Unexpected internal error";this.message=e,this.toString=function(){return e}},n.errors.InvalidStateException=function(){n.errors.Exception.apply(this,arguments)},n.dateFormat=t.time.format("%m/%d/%Y"),n.printers={},n.printers.filters=function(t){for(var e="",r=0;r<t.length;++r)r>0&&(e+=", "),e+=n.printers.filter(t[r]);return e},n.printers.filter=function(t){var e="";return t&&(t instanceof Array?t.length>=2?e="["+n.utils.printSingleValue(t[0])+" -> "+n.utils.printSingleValue(t[1])+"]":t.length>=1&&(e=n.utils.printSingleValue(t[0])):e=n.utils.printSingleValue(t)),e},n.utils={},n.utils.printSingleValue=function(t){var e=""+t;return t instanceof Date?e=n.dateFormat(t):"string"==typeof t?e=t:n.utils.isFloat(t)?e=n.utils.printSingleValue.fformat(t):n.utils.isInteger(t)&&(e=Math.round(t)),e},n.utils.printSingleValue.fformat=t.format(".2f"),n.utils.add=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()+e),n}if("string"==typeof e){var r=+e/100;return t>0?t*(1+r):t*(1-r)}return t+e},n.utils.subtract=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()-e),n}if("string"==typeof e){var r=+e/100;return 0>t?t*(1+r):t*(1-r)}return t-e},n.utils.GroupStack=function(){function t(t){n[t]||(n[t]=[])}var e,n=[[]],r=[];this.setDataPoint=function(e,r,i){t(e),n[e][r]=i},this.getDataPoint=function(e,r){t(e);var i=n[e][r];return void 0===i&&(i=0),i},this.addGroup=function(t,n){return n||(n=e),r.push([t,n]),r.length-1},this.getGroupByIndex=function(t){return r[t][0]},this.getAccessorByIndex=function(t){return r[t][1]},this.size=function(){return r.length},this.clear=function(){n=[],r=[]},this.setDefaultAccessor=function(t){e=t},this.getDataLayers=function(){return n},this.toLayers=function(){for(var t=[],e=0;e<n.length;++e){for(var r={index:e,points:[]},i=n[e],a=0;a<i.length;++a)r.points.push(i[a]);t.push(r)}return t}},n.utils.isNumber=function(t){return t===+t},n.utils.isFloat=function(t){return t===+t&&t!==(0|t)},n.utils.isInteger=function(t){return t===+t&&t===(0|t)},n.utils.isNegligible=function(t){return void 0===t||t<n.constants.NEGLIGIBLE_NUMBER&&t>-n.constants.NEGLIGIBLE_NUMBER},n.utils.groupMax=function(e,r){var i=t.max(e.all(),function(t){return r(t)});return n.utils.isNegligible(i)&&(i=0),i},n.utils.groupMin=function(e,r){var i=t.min(e.all(),function(t){return r(t)});return n.utils.isNegligible(i)&&(i=0),i},n.utils.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},n.utils.appendOrSelect=function(t,e){var n=t.select(e);return n.empty()&&(n=t.append(e)),n},n.utils.createLegendable=function(t,e,n,r){var i={name:t._getGroupName(e,r),data:e};return"function"==typeof t.colors&&(i.color=t.colors()(n)),i},n.utils.safeNumber=function(t){return n.utils.isNumber(+t)?+t:0},n.events={current:null},n.events.trigger=function(t,e){return e?(n.events.current=t,void setTimeout(function(){t==n.events.current&&t()},e)):void t()},n.cumulative={},n.cumulative.Base=function(){this._keyIndex=[],this._map={},this.sanitizeKey=function(t){return t+=""},this.clear=function(){this._keyIndex=[],this._map={}},this.size=function(){return this._keyIndex.length},this.getValueByKey=function(t){t=this.sanitizeKey(t);var e=this._map[t];return e},this.setValueByKey=function(t,e){return t=this.sanitizeKey(t),this._map[t]=e},this.indexOfKey=function(t){return t=this.sanitizeKey(t),this._keyIndex.indexOf(t)},this.addToIndex=function(t){t=this.sanitizeKey(t),this._keyIndex.push(t)},this.getKeyByIndex=function(t){return this._keyIndex[t]}},n.cumulative.Sum=function(){n.cumulative.Base.apply(this,arguments),this.add=function(t,e){e||(e=0),void 0===this.getValueByKey(t)?(this.addToIndex(t),this.setValueByKey(t,e)):this.setValueByKey(t,this.getValueByKey(t)+e)},this.minus=function(t,e){this.setValueByKey(t,this.getValueByKey(t)-e)},this.cumulativeSum=function(t){var e=this.indexOfKey(t);if(0>e)return 0;for(var n=0,r=0;e>=r;++r){var i=this.getKeyByIndex(r);n+=this.getValueByKey(i)}return n}},n.cumulative.Sum.prototype=new n.cumulative.Base,n.cumulative.CountUnique=function(){function t(t){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n}n.cumulative.Base.apply(this,arguments),this.add=function(t,e){void 0===this.getValueByKey(t)&&(this.setValueByKey(t,{}),this.addToIndex(t)),void 0!==e&&(void 0===this.getValueByKey(t)[e]&&(this.getValueByKey(t)[e]=0),this.getValueByKey(t)[e]+=1)},this.minus=function(t,e){this.getValueByKey(t)[e]-=1,this.getValueByKey(t)[e]<=0&&delete this.getValueByKey(t)[e]},this.count=function(e){return t(this.getValueByKey(e))},this.cumulativeCount=function(t){var e=this.indexOfKey(t);if(0>e)return 0;for(var n=0,r=0;e>=r;++r){var i=this.getKeyByIndex(r);n+=this.count(i)}return n}},n.cumulative.CountUnique.prototype=new n.cumulative.Base,n.baseChart=function(r){function i(t,e,n){var r=t.anchor(),i="__names__";n&&n!=t.valueAccessor()||(n="default"),e[i]||(e[i]={}),e[i][r]||(e[i][r]={a:[],n:[]});var a=e[i][r].a.indexOf(n);return-1==a&&(a=e[i][r].a.length,e[i][r].a[a]=n,e[i][r].n[a]={name:""}),e[i][r].n[a]}function a(){return p=r.root().append("svg").attr("width",r.width()).attr("height",r.height())}function u(t){w.splice(w.indexOf(t),1),l(),r._invokeFilteredListener(t)}function o(t){w.push(t),l(),r._invokeFilteredListener(t)}function s(){w=[],l(),r._invokeFilteredListener(null)}function l(){if(r.dataSet()&&void 0!==r.dimension().filter){var t=G(r.dimension(),w);w=t?t:w}}function c(){for(var t=0;t<E.length;++t)E[t](r)}r.__dc_flag__=!0;var f,d,g,h,p,v,m=200,y=200,x=function(t){return t.key},A=function(t){return t.value},b=function(t){return t.key},C=function(t){return t.key},_=!1,L=function(t){return t.key+": "+t.value},D=!1,S=750,k=n.printers.filters,E=[],R=n.constants.DEFAULT_CHART_GROUP,B=function(){},N={preRender:B,postRender:B,preRedraw:B,postRedraw:B,filtered:B,zoomed:B},w=[],G=function(t,e){return t.filter(null),0===e.length?t.filter(null):1===e.length?t.filter(e[0]):t.filterFunction(function(t){return e.indexOf(t)>=0}),e};return r.width=function(t){return arguments.length?(m=t,r):m},r.height=function(t){return arguments.length?(y=t,r):y},r.dimension=function(t){return arguments.length?(f=t,r.expireCache(),r):f},r.group=function(t,e){return arguments.length?(d=t,r.expireCache(),"string"==typeof e&&r._setGroupName(d,e),r):d},r._getGroupName=function(t,e){return i(r,t,e).name},r._setGroupName=function(t,e,n){i(r,t,n).name=e},r.ordering=function(t){return arguments.length?(b=t,r.expireCache(),r):b},r.computeOrderedGroups=function(t){var n=t?t:r.group().all().slice(0);if(n.length<2)return n;var i=e.quicksort.by(r.ordering());return i(n,0,n.length)},r.filterAll=function(){return r.filter(null)},r.dataSet=function(){return void 0!==f&&void 0!==d},r.select=function(t){return h.select(t)},r.selectAll=function(t){return h?h.selectAll(t):null},r.anchor=function(e,i){return arguments.length?(n.instanceOfChart(e)?(g=e.anchor(),h=e.root()):(g=e,h=t.select(g),h.classed(n.constants.CHART_CLASS,!0),n.registerChart(r,i)),R=i,r):g},r.anchorName=function(){var t=r.anchor();return t&&t.id?t.id:t?t.replace("#",""):""},r.root=function(t){return arguments.length?(h=t,r):h},r.svg=function(t){return arguments.length?(p=t,r):p},r.resetSvg=function(){return r.select("svg").remove(),a()},r.filterPrinter=function(t){return arguments.length?(k=t,r):k},r.turnOnControls=function(){return h&&(r.selectAll(".reset").style("display",null),r.selectAll(".filter").text(k(r.filters())).style("display",null)),r},r.turnOffControls=function(){return h&&(r.selectAll(".reset").style("display","none"),r.selectAll(".filter").style("display","none").text(r.filter())),r},r.transitionDuration=function(t){return arguments.length?(S=t,r):S},r.render=function(){if(N.preRender(r),void 0===f)throw new n.errors.InvalidStateException("Mandatory attribute chart.dimension is missing on chart[#"+r.anchorName()+"]");if(void 0===d)throw new n.errors.InvalidStateException("Mandatory attribute chart.group is missing on chart[#"+r.anchorName()+"]");var t=r.doRender();return v&&v.render(),r.activateRenderlets("postRender"),t},r.activateRenderlets=function(t){r.transitionDuration()>0&&p?p.transition().duration(r.transitionDuration()).each("end",function(){c(),t&&N[t](r)}):(c(),t&&N[t](r))},r.redraw=function(){N.preRedraw(r);var t=r.doRedraw();return r.activateRenderlets("postRedraw"),t},r._invokeFilteredListener=function(t){void 0!==t&&N.filtered(r,t)},r._invokeZoomedListener=function(){N.zoomed(r)},r.hasFilter=function(t){return arguments.length?w.indexOf(t)>=0:w.length>0},r.filter=function(t){return arguments.length?(null===t?s():r.hasFilter(t)?u(t):o(t),null!==h&&r.hasFilter()?r.turnOnControls():r.turnOffControls(),r):w.length>0?w[0]:null},r.filters=function(){return w},r.highlightSelected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!0),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.fadeDeselected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!0)},r.resetHighlight=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.onClick=function(t){var e=r.keyAccessor()(t);n.events.trigger(function(){r.filter(e),n.redrawAll(r.chartGroup())})},r.filterHandler=function(t){return arguments.length?(G=t,r):G},r.doRender=function(){return r},r.doRedraw=function(){return r},r.legendables=function(){return[]},r.legendHighlight=function(){},r.legendReset=function(){},r.keyAccessor=function(t){return arguments.length?(x=t,r):x},r.valueAccessor=function(t){return arguments.length?(A=t,r):A},r.label=function(t){return arguments.length?(C=t,_=!0,r):C},r.renderLabel=function(t){return arguments.length?(_=t,r):_},r.title=function(t){return arguments.length?(L=t,D=!0,r):L},r.renderTitle=function(t){return arguments.length?(D=t,r):D},r.renderlet=function(t){return E.push(t),r},r.chartGroup=function(t){return arguments.length?(R=t,r):R},r.expireCache=function(){return r},r.legend=function(t){return arguments.length?(v=t,v.parent(r),r):v},r.on=function(t,e){return N[t]=e,r},r},n.marginable=function(t){var e={top:10,right:50,bottom:30,left:30};return t.margins=function(n){return arguments.length?(e=n,t):e},t.effectiveWidth=function(){return t.width()-t.margins().left-t.margins().right},t.effectiveHeight=function(){return t.height()-t.margins().top-t.margins().bottom},t},n.coordinateGridChart=function(e){function r(t){e.elasticX()&&!e.isOrdinal()?_.domain([e.xAxisMin(),e.xAxisMax()]):e.isOrdinal()&&0===_.domain().length&&_.domain(e.computeOrderedGroups().map(function(t){return t.key})),e.isOrdinal()?e.prepareOrdinalXAxis():_.range([0,e.xAxisLength()]),w=w.scale(e.x()).orient("bottom"),i(t)}function i(t){var r=t.selectAll("g."+v);if(z){r.empty()&&(r=t.insert("g",":first-child").attr("class",h+" "+v).attr("transform","translate("+e.yAxisX()+","+e.margins().top+")"));var i=w.tickValues()?w.tickValues():_.ticks(w.ticks()[0]),a=r.selectAll("line").data(i),u=a.enter().append("line").attr("x1",function(t){return _(t)}).attr("y1",e.xAxisY()-e.margins().top).attr("x2",function(t){return _(t)}).attr("y2",0).attr("opacity",0);n.transition(u,e.transitionDuration()).attr("opacity",1),n.transition(a,e.transitionDuration()).attr("x1",function(t){return _(t)}).attr("y1",e.xAxisY()-e.margins().top).attr("x2",function(t){return _(t)}).attr("y2",0),a.exit().remove()}else r.selectAll("line").remove()}function a(n){(void 0===S||e.elasticY())&&(S=t.scale.linear(),S.domain([e.yAxisMin(),e.yAxisMax()]).rangeRound([e.yAxisHeight(),0])),S.range([e.yAxisHeight(),0]),I=I.scale(S).orient("left"),u(n)}function u(t){var r=t.selectAll("g."+p);if(_renderHorizontalGridLine){var i=I.tickValues()?I.tickValues():S.ticks(I.ticks()[0]);r.empty()&&(r=t.insert("g",":first-child").attr("class",h+" "+p).attr("transform","translate("+e.yAxisX()+","+e.margins().top+")"));var a=r.selectAll("line").data(i),u=a.enter().append("line").attr("x1",1).attr("y1",function(t){return S(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return S(t)}).attr("opacity",0);n.transition(u,e.transitionDuration()).attr("opacity",1),n.transition(a,e.transitionDuration()).attr("x1",1).attr("y1",function(t){return S(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return S(t)}),a.exit().remove()}else r.selectAll("line").remove()}function o(){return e.xAxisY()-e.margins().top}function s(){var t=e.extendBrush();e.redrawBrush(b),e.brushIsEmpty(t)?n.events.trigger(function(){e.filter(null),n.redrawAll(e.chartGroup())}):n.events.trigger(function(){e.filter(null),e.filter([t[0],t[1]]),n.redrawAll(e.chartGroup())},n.constants.EVENT_DELAY)}function l(){return e.anchorName()+"-clip"}function c(){var t=n.utils.appendOrSelect(A,"defs"),r=n.utils.appendOrSelect(t,"clipPath").attr("id",l()),i=2*j;n.utils.appendOrSelect(r,"rect").attr("width",e.xAxisLength()+i).attr("height",e.yAxisHeight()+i)}function f(){q&&e.root().call(t.behavior.zoom().x(e.x()).scaleExtent(X).on("zoom",function(){e.focus(e.x().domain()),e._invokeZoomedListener(),d()}))}function d(){if(B){var t=e.x().domain();if(Y){var r=B.xOriginalDomain(),i=[t[0]<r[0]?t[0]:r[0],t[1]>r[1]?t[1]:r[1]];B.focus(i)}else B.focus(t);B.filter(null),B.filter(t),n.events.trigger(function(){n.redrawAll(e.chartGroup())})}}function g(t){return t instanceof Array&&t.length>1}var h="grid-line",p="horizontal",v="vertical",m="y-axis-label",y="x-axis-label",x=12;e=n.colorChart(n.marginable(n.baseChart(e))),e.colors(t.scale.category10());var A,b,C,_,L,D,S,k,E,R,B,N,w=t.svg.axis(),G=n.units.integers,M=0,O=!1,T=0,I=t.svg.axis(),V=0,U=!1,K=0,H=t.svg.brush(),F=!0,z=!1,P=!1,X=[-10,100],Y=!0,q=!1,j=0;return e.title(function(t){return t.data.key+": "+t.data.value}),e.rescale=function(){R=void 0,e.xUnitCount()},e.rangeChart=function(t){return arguments.length?(B=t,B.focusChart(e),e):B},e.zoomScale=function(t){return arguments.length?(X=t,e):X},e.zoomOutRestrict=function(t){return arguments.length?(Y=t,e):Y},e._generateG=function(t){return A=void 0===t?e.svg():t,b=A.append("g"),C=b.append("g").attr("class","chart-body").attr("transform","translate("+e.margins().left+", "+e.margins().top+")").attr("clip-path","url(#"+l()+")"),b},e.g=function(t){return arguments.length?(b=t,e):b},e.mouseZoomable=function(t){return arguments.length?(q=t,e):q},e.chartBodyG=function(t){return arguments.length?(C=t,e):C},e.x=function(t){return arguments.length?(_=t,L=_.domain(),e):_},e.xOriginalDomain=function(){return L},e.xUnits=function(t){return arguments.length?(G=t,e):G},e.xAxis=function(t){return arguments.length?(w=t,e):w},e.elasticX=function(t){return arguments.length?(O=t,e):O},e.xAxisPadding=function(t){return arguments.length?(M=t,e):M},e.xUnitCount=function(){if(void 0===R){var t=e.xUnits()(e.x().domain()[0],e.x().domain()[1],e.x().domain());R=t instanceof Array?t.length:t}return R},e.isOrdinal=function(){return e.xUnits()===n.units.ordinal},e.prepareOrdinalXAxis=function(t){t||(t=e.xUnitCount());for(var n=[],r=e.xAxisLength()/(t+1),i=r/2,a=0;t>a;a++)n[a]=i,i+=r;_.range(n)},e.renderXAxis=function(t){var r=t.selectAll("g.x");r.empty()&&(r=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e.xAxisY()+")"));var i=t.selectAll("text."+y);i.empty()&&e.xAxisLabel()&&(i=t.append("text").attr("transform","translate("+e.xAxisLength()/2+","+(e.height()-T)+")").attr("class",y).attr("text-anchor","middle").text(e.xAxisLabel())),e.xAxisLabel()&&i.text()!=e.xAxisLabel()&&axisYLab.text(e.xAxisLabel()),n.transition(r,e.transitionDuration()).call(w)},e.xAxisY=function(){return e.height()-e.margins().bottom},e.xAxisLength=function(){return e.effectiveWidth()},e.xAxisLabel=function(t,n){return arguments.length?(D=t,e.margins().bottom-=T,T=void 0===n?x:n,e.margins().bottom+=T,e):D},e.renderYAxis=function(t){var r=t.selectAll("g.y");r.empty()&&(r=t.append("g").attr("class","axis y").attr("transform","translate("+e.yAxisX()+","+e.margins().top+")"));var i=t.selectAll("text."+m);i.empty()&&e.yAxisLabel()&&(i=t.append("text").attr("transform","translate("+K+","+e.yAxisHeight()/2+"),rotate(-90)").attr("class",m).attr("text-anchor","middle").text(e.yAxisLabel())),e.yAxisLabel()&&i.text()!=e.yAxisLabel()&&i.text(e.yAxisLabel()),n.transition(r,e.transitionDuration()).call(I)},e.yAxisX=function(){return e.margins().left},e.yAxisLabel=function(t,n){return arguments.length?(k=t,e.margins().left-=K,K=void 0===n?x:n,e.margins().left+=K,e):k},e.y=function(t){return arguments.length?(S=t,e):S},e.yAxis=function(t){return arguments.length?(I=t,e):I},e.elasticY=function(t){return arguments.length?(U=t,e):U},e.renderHorizontalGridLines=function(t){return arguments.length?(_renderHorizontalGridLine=t,e):_renderHorizontalGridLine},e.renderVerticalGridLines=function(t){return arguments.length?(z=t,e):z},e.xAxisMin=function(){var r=t.min(e.group().all(),function(t){return e.keyAccessor()(t)});return n.utils.subtract(r,M)},e.xAxisMax=function(){var r=t.max(e.group().all(),function(t){return e.keyAccessor()(t)});return n.utils.add(r,M)},e.yAxisMin=function(){var r=t.min(e.group().all(),function(t){return e.valueAccessor()(t)});return r=n.utils.subtract(r,V)},e.yAxisMax=function(){var r=t.max(e.group().all(),function(t){return e.valueAccessor()(t)});return r=n.utils.add(r,V)},e.yAxisPadding=function(t){return arguments.length?(V=t,e):V},e.yAxisHeight=function(){return e.effectiveHeight()},e.round=function(t){return arguments.length?(E=t,e):E},n.override(e,"filter",function(t){return arguments.length?(e._filter(t),t?e.brush().extent(t):e.brush().clear(),e):e._filter()}),e.brush=function(t){return arguments.length?(H=t,e):H},e.renderBrush=function(t){if(e.isOrdinal()&&(F=!1),F){H.on("brush",s);var n=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")").call(H.x(e.x()));n.selectAll("rect").attr("height",o()),n.selectAll(".resize").append("path").attr("d",e.resizeHandlePath),e.hasFilter()&&e.redrawBrush(t)}},e.extendBrush=function(){var t=H.extent();return e.round()&&(t[0]=t.map(e.round())[0],t[1]=t.map(e.round())[1],b.select(".brush").call(H.extent(t))),t},e.brushIsEmpty=function(t){return H.empty()||!t||t[1]<=t[0]},e.redrawBrush=function(t){if(F){e.filter()&&e.brush().empty()&&e.brush().extent(e.filter());var n=t.select("g.brush");n.call(e.brush().x(e.x())),n.selectAll("rect").attr("height",o())}e.fadeDeselectedArea()},e.fadeDeselectedArea=function(){},e.resizeHandlePath=function(t){var e=+("e"==t),n=e?1:-1,r=o()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+e+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)},e.clipPadding=function(t){return arguments.length?(j=t,e):j},e.doRender=function(){if(void 0===_)throw new n.errors.InvalidStateException("Mandatory attribute chart.x is missing on chart[#"+e.anchorName()+"]");return e.resetSvg(),e.dataSet()&&(e._generateG(),c(),r(e.g()),a(e.g()),e.plotData(),e.renderXAxis(e.g()),e.renderYAxis(e.g()),e.renderBrush(e.g()),f()),e},e.doRedraw=function(){return r(e.g()),a(e.g()),e.plotData(),e.elasticY()&&e.renderYAxis(e.g()),(e.elasticX()||P)&&e.renderXAxis(e.g()),e.redrawBrush(e.g()),e},e.subRender=function(){return e.dataSet()&&e.plotData(),e},e.brushOn=function(t){return arguments.length?(F=t,e):F},e.focus=function(t){P=!0,e.x().domain(g(t)?t:e.xOriginalDomain()),e.rescale(),e.redraw(),g(t)||(P=!1)},e.refocused=function(){return P},e.focusChart=function(t){return arguments.length?(N=t,e.on("filtered",function(t){n.events.trigger(function(){N.focus(t.filter()),N.filter(t.filter()),n.redrawAll(t.chartGroup())})}),e):N},e},n.colorChart=function(e){var r=t.scale.category20c(),i=[0,r.range().length],a=function(t){var a=i;"function"==typeof i&&(a=i.call(e));var u=a[0],o=a[1];if(isNaN(t)&&(t=0),!n.utils.isNumber(o))return r(t);var s=e.colors().range().length,l=(o-u)/s,c=Math.abs(Math.min(s-1,Math.round((t-u)/l)));return e.colors()(c)},u=function(t,e){return e};return e.colors=function(n){if(!arguments.length)return r;if(n instanceof Array){r=t.scale.ordinal().range(n);for(var a=[],u=0;u<n.length;++u)a.push(u);r.domain(a)}else r=n;return i=[0,r.range().length],e},e.colorCalculator=function(t){return arguments.length?(a=t,e):a},e.getColor=function(t,e){return a(u(t,e))},e.colorAccessor=function(t){return arguments.length?(u=t,e):u},e.colorDomain=function(t){return arguments.length?(i=t,e):i},e},n.stackableChart=function(e){function r(){var n=[];if(e.x()){var r,i=e.x().domain();if(e.isOrdinal()){var a=t.set(i);r=function(t){return a.has(t.x)}}else r=function(t){return t.x>=i[0]&&t.x<=i[i.length-1]};e.stackLayers().forEach(function(t){t.points.forEach(function(t){r(t)&&n.push(t)})})}else e.stackLayers().forEach(function(t){n=n.concat(t.points)});return n}function i(t,n){return e.getKeyAccessorByIndex(t)(n)}function a(t,n){return e.getValueAccessorByIndex(t)(n)}function u(t,e){for(var n=0;n<t.length;++n){var r=t[n],u=i(e,r),o=a(e,r);f.setDataPoint(e,n,{data:r,x:u,y:o,layer:e})}}var o,s,l,c,f=new n.utils.GroupStack,d=t.layout.stack().offset("zero").order("default").values(function(t){return t.points});return e.stack=function(t,n,r){return arguments.length||f.clear(),"string"==typeof n?e._setGroupName(t,n,r):"function"==typeof n&&(r=n),f.setDefaultAccessor(e.valueAccessor()),f.addGroup(t,r),e.expireCache(),e},e.expireCache=function(){return o=null,s=null,l=null,c=null,e},e.allGroups=function(){if(null===o){o=[],o.push(e.group());for(var t=0;t<f.size();++t)o.push(f.getGroupByIndex(t))}return o},e.allValueAccessors=function(){if(null===s){s=[],s.push(e.valueAccessor());for(var t=0;t<f.size();++t)s.push(f.getAccessorByIndex(t))}return s},e.getValueAccessorByIndex=function(t){return e.allValueAccessors()[t]},e.yAxisMin=function(){var i,a=r();return i=t.min(a,function(t){return t.y+t.y0<t.y0?t.y+t.y0:t.y0}),i=n.utils.subtract(i,e.yAxisPadding())},e.yAxisMax=function(){var i,a=r();return i=t.max(a,function(t){return t.y+t.y0}),i=n.utils.add(i,e.yAxisPadding())},e.allKeyAccessors=function(){if(null===l){l=[],l.push(e.keyAccessor());for(var t=0;t<f.size();++t)l.push(e.keyAccessor())}return l},e.getKeyAccessorByIndex=function(t){return e.allKeyAccessors()[t]},e.xAxisMin=function(){for(var t=null,r=e.allGroups(),i=0;i<r.length;++i){var a=r[i],u=n.utils.groupMin(a,e.getKeyAccessorByIndex(i));(null===t||t>u)&&(t=u)}return n.utils.subtract(t,e.xAxisPadding())},e.xAxisMax=function(){for(var t=null,r=e.allGroups(),i=0;i<r.length;++i){var a=r[i],u=n.utils.groupMax(a,e.getKeyAccessorByIndex(i));(null===t||u>t)&&(t=u)}return n.utils.add(t,e.xAxisPadding())},e.calculateDataPointMatrixForAll=function(){for(var t=e.allGroups(),n=0;n<t.length;++n){var r=t[n],i=r.all();u(i,n)}},e.getChartStack=function(){return f},n.override(e,"valueAccessor",function(t){return arguments.length?(e.expireCache(),e._valueAccessor(t)):e._valueAccessor()}),n.override(e,"keyAccessor",function(t){return arguments.length?(e.expireCache(),e._keyAccessor(t)):e._keyAccessor()}),e.stackLayout=function(t){return arguments.length?(d=t,e):d},e.stackLayers=function(t){return arguments.length?void(c=t):(null===c&&(e.calculateDataPointMatrixForAll(),c=e.stackLayout()(f.toLayers())),c)},e.colorAccessor(function(t){return t.layer||t.index}),e.legendables=function(){var t=[];return o.forEach(function(r,i){t.push(n.utils.createLegendable(e,r,i,e.getValueAccessorByIndex(i)))}),t},e},n.abstractBubbleChart=function(e){var r=.3,i=10;e.BUBBLE_NODE_CLASS="node",e.BUBBLE_CLASS="bubble",e.MIN_RADIUS=10,e=n.colorChart(e),e.renderLabel(!0),e.renderTitle(!1);var a=t.scale.linear().domain([0,100]),u=function(t){return t.r};e.r=function(t){return arguments.length?(a=t,e):a},e.radiusValueAccessor=function(t){return arguments.length?(u=t,e):u},e.rMin=function(){var n=t.min(e.group().all(),function(t){return e.radiusValueAccessor()(t)});return n},e.rMax=function(){var n=t.max(e.group().all(),function(t){return e.radiusValueAccessor()(t)});return n},e.bubbleR=function(t){var n=e.radiusValueAccessor()(t),r=e.r()(n);return(isNaN(r)||0>=n)&&(r=0),r};var o=function(t){return e.label()(t)},s=function(t){return e.bubbleR(t)>i?1:0};e.doRenderLabel=function(t){if(e.renderLabel()){var r=t.select("text");r.empty()&&(r=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)),r.attr("opacity",0).text(o),n.transition(r,e.transitionDuration()).attr("opacity",s)}},e.doUpdateLabels=function(t){if(e.renderLabel()){var r=t.selectAll("text").text(o);n.transition(r,e.transitionDuration()).attr("opacity",s)}};var l=function(t){return e.title()(t)};return e.doRenderTitles=function(t){if(e.renderTitle()){var n=t.select("title");n.empty()&&t.append("title").text(l)}},e.doUpdateTitles=function(t){e.renderTitle()&&t.selectAll("title").text(l)},e.minRadiusWithLabel=function(t){return arguments.length?(i=t,e):i},e.maxBubbleRelativeSize=function(t){return arguments.length?(r=t,e):r},e.initBubbleColor=function(t,r){return this[n.constants.NODE_INDEX_NAME]=r,e.getColor(t,r)},e.updateBubbleColor=function(t){return e.getColor(t,this[n.constants.NODE_INDEX_NAME])},e.fadeDeselectedArea=function(){e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(e.hasFilter()?function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}:function(){e.resetHighlight(this)})},e.isSelectedNode=function(t){return e.hasFilter(t.key)},e.onClick=function(t){var r=t.key;n.events.trigger(function(){e.filter(r),n.redrawAll(e.chartGroup())})},e},n.pieChart=function(e,r){function i(){if(R.dataSet()){var e=v();_=_?_:t.min([R.width(),R.height()])/2;var n=R.buildArcs(),r=e(R.assembleCappedData());if(L){var i=L.selectAll("g."+S).data(r);a(i,n,r),c(r,n),h(i),p()}}}function a(t,e,n){var r=u(t);o(r,e),s(r),l(n,e)}function u(t){var e=t.enter().append("g").attr("class",function(t,e){return S+" _"+e});return e}function o(t,e){var n=t.append("path").attr("fill",function(t,e){return R.getColor(t,e)}).on("click",b).attr("d",function(t,n){return C(t,n,e)});n.transition().duration(R.transitionDuration()).attrTween("d",x)}function s(t){R.renderTitle()&&t.append("title").text(function(t){return R.title()(t)})}function l(t,e){if(R.renderLabel()){var r=L.selectAll("text."+S).data(t);r.exit().remove();var i=r.enter().append("text").attr("class",function(t,e){return S+" _"+e}).on("click",b);n.transition(i,R.transitionDuration()).attr("transform",function(t){t.innerRadius=R.innerRadius(),t.outerRadius=_;var n=e.centroid(t);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(t){var e=t.data;return y(e)||m(t)?"":R.label()(t)})}}function c(t,e){f(t,e),d(t,e),g(t)}function f(t,e){var r=L.selectAll("g."+S).data(t).select("path").attr("d",function(t,n){return C(t,n,e)});n.transition(r,R.transitionDuration(),function(t){t.attrTween("d",x)}).attr("fill",function(t,e){return R.getColor(t,e)})}function d(t,e){if(R.renderLabel()){var r=L.selectAll("text."+S).data(t);n.transition(r,R.transitionDuration()).attr("transform",function(t){t.innerRadius=R.innerRadius(),t.outerRadius=_;var n=e.centroid(t);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(t){var e=t.data;return y(e)||m(t)?"":R.label()(t)})}}function g(t){R.renderTitle()&&L.selectAll("g."+S).data(t).select("title").text(function(t){return R.title()(t)})}function h(t){t.exit().remove()}function p(){R.selectAll("g."+S).each(R.hasFilter()?function(t){R.isSelectedSlice(t)?R.highlightSelected(this):R.fadeDeselected(this)}:function(){R.resetHighlight(this)})}function v(){return t.layout.pie().sort(null).value(function(t){return R.valueAccessor()(t)})}function m(t){var e=t.endAngle-t.startAngle;return isNaN(e)||E>e}function y(t){return 0===R.valueAccessor()(t)}function x(e){e.innerRadius=R.innerRadius();var n=this._current;A(n)&&(n={startAngle:0,endAngle:0});var r=t.interpolate(n,e);return this._current=r(0),function(t){return C(r(t),0,R.buildArcs())}}function A(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}function b(t){R.onClick(t.data)}function C(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}var _,L,D=.5,S="pie-slice",k=0,E=D,R=n.capped(n.colorChart(n.baseChart({})));return R.slicesCap=R.cap,R.label(function(t){return R.keyAccessor()(t.data)}),R.renderLabel(!0),R.title(function(t){return R.keyAccessor()(t.data)+": "+R.valueAccessor()(t.data)}),R.transitionDuration(350),R.doRender=function(){return R.resetSvg(),L=R.svg().append("g").attr("transform","translate("+R.cx()+","+R.cy()+")"),i(),R},R.innerRadius=function(t){return arguments.length?(k=t,R):k},R.radius=function(t){return arguments.length?(_=t,R):_},R.cx=function(){return R.width()/2},R.cy=function(){return R.height()/2},R.buildArcs=function(){return t.svg.arc().outerRadius(_).innerRadius(k)},R.isSelectedSlice=function(t){return R.hasFilter(R.keyAccessor()(t.data))},R.doRedraw=function(){return i(),R},R.minAngleForLabel=function(t){return arguments.length?(E=t,R):E},R.anchor(e,r)},n.barChart=function(e,r){function i(t){return n.utils.safeNumber(Math.abs(g.y()(t.y+t.y0)-g.y()(t.y0)))}function a(t,e){var r=t.selectAll("rect.bar").data(e.points);r.enter().append("rect").attr("class","bar").attr("fill",g.getColor).append("title").text(g.title()),g.isOrdinal()&&r.on("click",s),n.transition(r,g.transitionDuration()).attr("x",function(t){var e=g.x()(t.x);return(p||g.isOrdinal())&&(e-=c/2),n.utils.safeNumber(e)}).attr("y",function(t){var e=g.y()(t.y+t.y0);return t.y<0&&(e-=i(t)),n.utils.safeNumber(e)}).attr("width",c).attr("height",function(t){return i(t)}).select("title").text(g.title()),n.transition(r.exit(),g.transitionDuration()).attr("height",0).remove()}function u(){if(void 0===c){var t=g.isOrdinal()?o()+1:o(),e=Math.floor((g.xAxisLength()-(t-1)*h)/t);(1/0==e||isNaN(e)||f>e)&&(e=f),c=e
}}function o(){return void 0===l&&(l=g.xUnitCount()),l}function s(t){g.onClick(t.data)}var l,c,f=1,d=2,g=n.stackableChart(n.coordinateGridChart({})),h=d,p=!1;return n.override(g,"rescale",function(){g._rescale(),l=void 0,c=void 0,o()}),g.plotData=function(){var e=g.chartBodyG().selectAll("g.stack").data(g.stackLayers());u(),e.enter().append("g").attr("class",function(t,e){return"stack _"+e}),e.each(function(e,n){var r=t.select(this);a(r,e,n)}),g.stackLayers(null)},g.fadeDeselectedArea=function(){var t=g.chartBodyG().selectAll("rect.bar"),e=g.brush().extent();if(g.isOrdinal())g.hasFilter()?(t.classed(n.constants.SELECTED_CLASS,function(t){return g.hasFilter(g.keyAccessor()(t.data))}),t.classed(n.constants.DESELECTED_CLASS,function(t){return!g.hasFilter(g.keyAccessor()(t.data))})):(t.classed(n.constants.SELECTED_CLASS,!1),t.classed(n.constants.DESELECTED_CLASS,!1));else if(g.brushIsEmpty(e))t.classed(n.constants.DESELECTED_CLASS,!1);else{var r=e[0],i=e[1];t.classed(n.constants.DESELECTED_CLASS,function(t){var e=g.keyAccessor()(t.data);return r>e||e>=i})}},g.centerBar=function(t){return arguments.length?(p=t,g):p},g.gap=function(t){return arguments.length?(h=t,g):h},g.extendBrush=function(){var t=g.brush().extent();return g.round()&&!p&&(t[0]=t.map(g.round())[0],t[1]=t.map(g.round())[1],g.chartBodyG().select(".brush").call(g.brush().extent(t))),t},g.legendHighlight=function(e){g.select(".chart-body").selectAll("rect.bar").filter(function(){return t.select(this).attr("fill")==e.color}).classed("highlight",!0),g.select(".chart-body").selectAll("rect.bar").filter(function(){return t.select(this).attr("fill")!=e.color}).classed("fadeout",!0)},g.legendReset=function(e){g.selectAll(".chart-body").selectAll("rect.bar").filter(function(){return t.select(this).attr("fill")==e.color}).classed("highlight",!1),g.selectAll(".chart-body").selectAll("rect.bar").filter(function(){return t.select(this).attr("fill")!=e.color}).classed("fadeout",!1)},g.anchor(e,r)},n.lineChart=function(e,r){function i(e,r){var i=t.svg.line().x(function(t){return x.x()(t.x)}).y(function(t){return x.y()(t.y+t.y0)}).interpolate(C).tension(_);g&&i.defined(g),e.append("path").attr("class","line").attr("stroke",x.getColor).attr("fill",x.getColor),n.transition(r.select("path.line"),x.transitionDuration()).attr("d",function(t){return u(i(t.points))})}function a(e,r){if(A){var i=t.svg.area().x(function(t){return x.x()(t.x)}).y(function(t){return x.y()(t.y+t.y0)}).y0(function(t){return x.y()(t.y0)}).interpolate(C).tension(_);g&&i.defined(g),e.append("path").attr("class","area").attr("fill",x.getColor).attr("d",function(t){return u(i(t.points))}),n.transition(r.select("path.area"),x.transitionDuration()).attr("d",function(t){return u(i(t.points))})}}function u(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}function o(e){x.brushOn()||e.each(function(){var e=t.select(this),r=e.select("g."+p);r.empty()&&(r=e.append("g").attr("class",p)),s(r);var i=r.selectAll("circle."+v).data(r.datum().points);i.enter().append("circle").attr("class",v).attr("r",b).attr("fill",x.getColor).style("fill-opacity",1e-6).style("stroke-opacity",1e-6).on("mousemove",function(){var e=t.select(this);l(e),c(e,r)}).on("mouseout",function(){var e=t.select(this);f(e),d(r)}).append("title").text(x.title()),i.attr("cx",function(t){return n.utils.safeNumber(x.x()(t.x))}).attr("cy",function(t){return n.utils.safeNumber(x.y()(t.y+t.y0))}).select("title").text(x.title()),i.exit().remove()})}function s(t){var e=t.select("path."+m).empty()?t.append("path").attr("class",m):t.select("path."+m);e.style("display","none").attr("stroke-dasharray","5,5");var n=t.select("path."+y).empty()?t.append("path").attr("class",y):t.select("path."+y);n.style("display","none").attr("stroke-dasharray","5,5")}function l(t){return t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t}function c(t,e){var n=t.attr("cx"),r=t.attr("cy");e.select("path."+m).style("display","").attr("d","M0 "+r+"L"+n+" "+r),e.select("path."+y).style("display","").attr("d","M"+n+" "+x.yAxisHeight()+"L"+n+" "+r)}function f(t){t.style("fill-opacity",1e-6).style("stroke-opacity",1e-6)}function d(t){t.select("path."+m).style("display","none"),t.select("path."+y).style("display","none")}var g,h=5,p="dc-tooltip",v="dot",m="yRef",y="xRef",x=n.stackableChart(n.coordinateGridChart({})),A=!1,b=h,C="linear",_=.7;return x.transitionDuration(500),x.plotData=function(){var t=x.chartBodyG().selectAll("g.stack").data(x.stackLayers()),e=t.enter().append("g").attr("class",function(t,e){return"stack _"+e});i(e,t),a(e,t),o(t),x.stackLayers(null)},x.interpolate=function(t){return arguments.length?(C=t,x):C},x.tension=function(t){return arguments.length?(_=t,x):_},x.defined=function(t){return arguments.length?(g=t,x):g},x.renderArea=function(t){return arguments.length?(A=t,x):A},x.dotRadius=function(t){return arguments.length?(b=t,x):b},x.legendHighlight=function(e){x.selectAll(".chart-body").selectAll("path").filter(function(){return t.select(this).attr("fill")==e.color}).classed("highlight",!0),x.selectAll(".chart-body").selectAll("path").filter(function(){return t.select(this).attr("fill")!=e.color}).classed("fadeout",!0)},x.legendReset=function(e){x.selectAll(".chart-body").selectAll("path").filter(function(){return t.select(this).attr("fill")==e.color}).classed("highlight",!1),x.selectAll(".chart-body").selectAll("path").filter(function(){return t.select(this).attr("fill")!=e.color}).classed("fadeout",!1)},x.anchor(e,r)},n.dataCount=function(e,r){var i=t.format(",d"),a=n.baseChart({});return a.doRender=function(){return a.selectAll(".total-count").text(i(a.dimension().size())),a.selectAll(".filter-count").text(i(a.group().value())),a},a.doRedraw=function(){return a.doRender()},a.anchor(e,r)},n.dataTable=function(r,i){function a(){var t=g.root().selectAll("tbody").data(u(),function(t){return g.keyAccessor()(t)}),e=t.enter().append("tbody");return e.append("tr").attr("class",d).append("td").attr("class",l).attr("colspan",p.length).html(function(t){return g.keyAccessor()(t)}),t.exit().remove(),e}function u(){s||(s=e.quicksort.by(v));var n=g.dimension().top(h);return t.nest().key(g.group()).sortKeys(m).sortValues(m).entries(s(n,0,n.length))}function o(t){for(var e=t.order().selectAll("tr."+c).data(function(t){return t.values}),n=e.enter().append("tr").attr("class",c),r=0;r<p.length;++r){var i=p[r];n.append("td").attr("class",f+" _"+r).html(function(t){return i(t)})}return e.exit().remove(),e}var s,l="dc-table-label",c="dc-table-row",f="dc-table-column",d="dc-table-group",g=n.baseChart({}),h=25,p=[],v=function(t){return t},m=t.ascending;return g.doRender=function(){return g.selectAll("tbody").remove(),o(a()),g},g.doRedraw=function(){return g.doRender()},g.size=function(t){return arguments.length?(h=t,g):h},g.columns=function(t){return arguments.length?(p=t,g):p},g.sortBy=function(t){return arguments.length?(v=t,g):v},g.order=function(t){return arguments.length?(m=t,g):m},g.anchor(r,i)},n.bubbleChart=function(t,e){function r(t){var e=t.enter().append("g");e.attr("class",s.BUBBLE_NODE_CLASS).attr("transform",c).append("circle").attr("class",function(t,e){return s.BUBBLE_CLASS+" _"+e}).on("click",s.onClick).attr("fill",s.initBubbleColor).attr("r",0),n.transition(t,s.transitionDuration()).attr("r",function(t){return s.bubbleR(t)}).attr("opacity",function(t){return s.bubbleR(t)>0?1:0}),s.doRenderLabel(e),s.doRenderTitles(e)}function i(t){n.transition(t,s.transitionDuration()).attr("transform",c).selectAll("circle."+s.BUBBLE_CLASS).attr("fill",s.updateBubbleColor).attr("r",function(t){return s.bubbleR(t)}).attr("opacity",function(t){return s.bubbleR(t)>0?1:0}),s.doUpdateLabels(t),s.doUpdateTitles(t)}function a(t){t.exit().remove()}function u(t){var e=s.x()(s.keyAccessor()(t));return isNaN(e)&&(e=0),e}function o(t){var e=s.y()(s.valueAccessor()(t));return isNaN(e)&&(e=0),e}var s=n.abstractBubbleChart(n.coordinateGridChart({})),l=!1;s.transitionDuration(750);var c=function(t){return"translate("+u(t)+","+o(t)+")"};return s.elasticRadius=function(t){return arguments.length?(l=t,s):l},s.plotData=function(){l&&s.r().domain([s.rMin(),s.rMax()]),s.r().range([s.MIN_RADIUS,s.xAxisLength()*s.maxBubbleRelativeSize()]);var t=s.chartBodyG().selectAll("g."+s.BUBBLE_NODE_CLASS).data(s.group().all());r(t),i(t),a(t),s.fadeDeselectedArea()},s.renderBrush=function(){},s.redrawBrush=function(){s.fadeDeselectedArea()},s.anchor(t,e)},n.compositeChart=function(e,r){function i(t,e){t._generateG(c.g()),t.g().attr("class",l+" _"+e)}function a(){for(var t=[],e=0;e<f.length;++e)t.push(f[e].yAxisMin());return t}function u(){for(var t=[],e=0;e<f.length;++e)t.push(f[e].yAxisMax());return t}function o(){for(var t=[],e=0;e<f.length;++e)t.push(f[e].xAxisMin());return t}function s(){for(var t=[],e=0;e<f.length;++e)t.push(f[e].xAxisMax());return t}var l="sub",c=n.coordinateGridChart({}),f=[];return c.transitionDuration(500),c.group({}),n.override(c,"_generateG",function(){for(var t=this.__generateG(),e=0;e<f.length;++e){var n=f[e];i(n,e),void 0===n.dimension()&&n.dimension(c.dimension()),void 0===n.group()&&n.group(c.group()),n.chartGroup(c.chartGroup()),n.svg(c.svg()),n.xUnits(c.xUnits()),n.transitionDuration(c.transitionDuration()),n.brushOn(c.brushOn())}return t}),c.plotData=function(){for(var t=0;t<f.length;++t){var e=f[t];void 0===e.g()&&i(e,t),e.x(c.x()),e.y(c.y()),e.xAxis(c.xAxis()),e.yAxis(c.yAxis()),e.plotData(),e.activateRenderlets()}},c.fadeDeselectedArea=function(){for(var t=0;t<f.length;++t){var e=f[t];e.brush(c.brush()),e.fadeDeselectedArea()}},c.compose=function(t){f=t;for(var e=0;e<f.length;++e){var n=f[e];n.height(c.height()),n.width(c.width()),n.margins(c.margins())}return c},c.children=function(){return f},c.yAxisMin=function(){return t.min(a())},c.yAxisMax=function(){return n.utils.add(t.max(u()),c.yAxisPadding())},c.xAxisMin=function(){return n.utils.subtract(t.min(o()),c.xAxisPadding())},c.xAxisMax=function(){return n.utils.add(t.max(s()),c.xAxisPadding())},c.legendables=function(){var t=[];return f.forEach(function(e,r){var i=e.legendables();i.length>1?t.push.apply(t,i):t.push(n.utils.createLegendable(e,e.group(),r,e.valueAccessor()))}),t},c.legendHighlight=function(t){for(var e=0;e<f.length;++e){var n=f[e];n.legendHighlight(t)}},c.legendReset=function(t){for(var e=0;e<f.length;++e){var n=f[e];n.legendReset(t)}},c.anchor(e,r)},n.geoChoroplethChart=function(e,r){function i(t){var e=a();if(u(t)){var n=o(t);g(n,t,e),h(n,t,e)}}function a(){for(var t={},e=p.group().all(),n=0;n<e.length;++n)t[p.keyAccessor()(e[n])]=p.valueAccessor()(e[n]);return t}function u(t){return d(t).keyAccessor}function o(t){var e=p.svg().selectAll(s(t)).classed("selected",function(e){return l(t,e)}).classed("deselected",function(e){return c(t,e)}).attr("class",function(e){var r=d(t).name,i=n.utils.nameToId(d(t).keyAccessor(e)),a=r+" "+i;return l(t,e)&&(a+=" selected"),c(t,e)&&(a+=" deselected"),a});return e}function s(t){return"g.layer"+t+" g."+d(t).name}function l(t,e){return p.hasFilter()&&p.hasFilter(f(t,e))}function c(t,e){return p.hasFilter()&&!p.hasFilter(f(t,e))}function f(t,e){return d(t).keyAccessor(e)}function d(t){return y[t]}function g(e,r,i){var a=e.select("path").attr("fill",function(){var e=t.select(this).attr("fill");return e?e:"none"}).on("click",function(t){return p.onClick(t,r)});n.transition(a,p.transitionDuration()).attr("fill",function(t,e){return p.getColor(i[d(r).keyAccessor(t)],e)})}function h(t,e,n){p.renderTitle()&&t.selectAll("title").text(function(t){var r=f(e,t),i=n[r];return p.title()({key:r,value:i})})}var p=n.colorChart(n.baseChart({}));p.colorAccessor(function(t){return t});var v,m=t.geo.path(),y=[];return p.doRender=function(){p.resetSvg();for(var t=0;t<y.length;++t){var e=p.svg().append("g").attr("class","layer"+t),n=e.selectAll("g."+d(t).name).data(d(t).data).enter().append("g").attr("class",d(t).name);n.append("path").attr("fill","white").attr("d",m),n.append("title"),i(t)}v=!1},p.onClick=function(t,e){var r=d(e).keyAccessor(t);n.events.trigger(function(){p.filter(r),n.redrawAll(p.chartGroup())})},p.doRedraw=function(){for(var t=0;t<y.length;++t)i(t),v&&p.svg().selectAll("g."+d(t).name+" path").attr("d",m);v=!1},p.overlayGeoJson=function(t,e,n){for(var r=0;r<y.length;++r)if(y[r].name==e)return y[r].data=t,y[r].keyAccessor=n,p;return y.push({name:e,data:t,keyAccessor:n}),p},p.projection=function(t){return m.projection(t),v=!0,p},p.geoJsons=function(){return y},p.removeGeoJson=function(t){for(var e=[],n=0;n<y.length;++n){var r=y[n];r.name!=t&&e.push(r)}return y=e,p},p.anchor(e,r)},n.bubbleOverlay=function(e,r){function i(){return l=g.select("g."+c),l.empty()&&(l=g.svg().append("g").attr("class",c)),l}function a(){var t=u();h.forEach(function(e){var r=o(e,t),i=r.select("circle."+d);i.empty()&&(i=r.append("circle").attr("class",d).attr("r",0).attr("fill",g.initBubbleColor).on("click",g.onClick)),n.transition(i,g.transitionDuration()).attr("r",function(t){return g.bubbleR(t)}),g.doRenderLabel(r),g.doRenderTitles(r)})}function u(){var t={};return g.group().all().forEach(function(e){t[g.keyAccessor()(e)]=e}),t}function o(t,e){var r=f+" "+n.utils.nameToId(t.name),i=l.select("g."+n.utils.nameToId(t.name));return i.empty()&&(i=l.append("g").attr("class",r).attr("transform","translate("+t.x+","+t.y+")")),i.datum(e[t.name]),i}function s(){var t=u();h.forEach(function(e){var r=o(e,t),i=r.select("circle."+d);n.transition(i,g.transitionDuration()).attr("r",function(t){return g.bubbleR(t)}).attr("fill",g.updateBubbleColor),g.doUpdateLabels(r),g.doUpdateTitles(r)})}var l,c="bubble-overlay",f="node",d="bubble",g=n.abstractBubbleChart(n.baseChart({})),h=[];return g.transitionDuration(750),g.radiusValueAccessor(function(t){return t.value}),g.point=function(t,e,n){return h.push({name:t,x:e,y:n}),g},g.doRender=function(){return l=i(),g.r().range([g.MIN_RADIUS,g.width()*g.maxBubbleRelativeSize()]),a(),g.fadeDeselectedArea(),g},g.doRedraw=function(){return s(),g.fadeDeselectedArea(),g},g.debug=function(e){if(e){var r=g.select("g."+n.constants.DEBUG_GROUP_CLASS);r.empty()&&(r=g.svg().append("g").attr("class",n.constants.DEBUG_GROUP_CLASS));var i=r.append("text").attr("x",10).attr("y",20);r.append("rect").attr("width",g.width()).attr("height",g.height()).on("mousemove",function(){var e=t.mouse(r.node()),n=e[0]+", "+e[1];i.text(n)})}else g.selectAll(".debug").remove();return g},g.anchor(e,r),g},n.rowChart=function(e,r){function i(){if(!m||y){var e=t.extent(x,L.valueAccessor());e[0]>0&&(e[0]=0),m=t.scale.linear().domain(e).range([0,L.effectiveWidth()]),D.scale(m)}}function a(){var t=v.select("g.axis");i(),t.empty()&&(t=v.append("g").attr("class","axis").attr("transform","translate(0, "+L.effectiveHeight()+")")),n.transition(t,L.transitionDuration()).call(D)}function u(){v.selectAll("g.tick").select("line.grid-line").remove(),v.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return-L.effectiveHeight()})}function o(){x=L.assembleCappedData(),a(),u();var t=v.selectAll("g."+_).data(x);s(t),l(t),c(t)}function s(t){var e=t.enter().append("g").attr("class",function(t,e){return _+" _"+e});e.append("rect").attr("width",0),d(e),g(t)}function l(t){t.exit().remove()}function c(t){var e=x.length,r=(L.effectiveHeight()-(e+1)*C)/e,i=t.attr("transform",function(t,e){return"translate(0,"+((e+1)*C+e*r)+")"}).select("rect").attr("height",r).attr("fill",L.getColor).on("click",h).classed("deselected",function(t){return L.hasFilter()?!L.isSelectedRow(t):!1}).classed("selected",function(t){return L.hasFilter()?L.isSelectedRow(t):!1});n.transition(i,L.transitionDuration()).attr("width",function(t){var e=m(m(0)==-1/0?1:0);return Math.abs(e-m(L.valueAccessor()(t)))}).attr("transform",p),f(t),g(t)}function f(t){L.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(function(t){return L.title()(t)}))}function d(t){L.renderLabel()&&t.append("text").on("click",h)}function g(t){if(L.renderLabel()){var e=t.select("text").attr("x",A).attr("y",b).on("click",h).attr("class",function(t,e){return _+" _"+e}).text(function(t){return L.label()(t)});n.transition(e,L.transitionDuration()).attr("transform",p)}}function h(t){L.onClick(t)}function p(t){var e=m(L.valueAccessor()(t)),n=m(0),r=e>n?n:e;return"translate("+r+",0)"}var v,m,y,x,A=10,b=15,C=5,_="row",L=n.capped(n.marginable(n.colorChart(n.baseChart({})))),D=t.svg.axis().orient("bottom");return L.rowsCap=L.cap,L.doRender=function(){return L.resetSvg(),v=L.svg().append("g").attr("transform","translate("+L.margins().left+","+L.margins().top+")"),o(),L},L.title(function(t){return L.keyAccessor()(t)+": "+L.valueAccessor()(t)}),L.label(function(t){return L.keyAccessor()(t)}),L.x=function(t){return arguments.length?(m=t,L):m},L.doRedraw=function(){return o(),L},L.xAxis=function(){return D},L.gap=function(t){return arguments.length?(C=t,L):C},L.elasticX=function(t){return arguments.length?(y=t,L):y},L.labelOffsetX=function(t){return arguments.length?(A=t,L):A},L.labelOffsetY=function(t){return arguments.length?(b=t,L):b},L.isSelectedRow=function(t){return L.hasFilter(L.keyAccessor()(t))},L.anchor(e,r)},n.legend=function(){function t(){return s+o}var e,n,r=2,i={},a=0,u=0,o=12,s=5;return i.parent=function(t){return arguments.length?(e=t,i):e},i.render=function(){n=e.svg().append("g").attr("class","dc-legend").attr("transform","translate("+a+","+u+")");var i=n.selectAll("g.dc-legend-item").data(e.legendables()).enter().append("g").attr("class","dc-legend-item").attr("transform",function(e,n){return"translate(0,"+n*t()+")"}).on("mouseover",function(t){e.legendHighlight(t)}).on("mouseout",function(t){e.legendReset(t)});i.append("rect").attr("width",o).attr("height",o).attr("fill",function(t){return t.color}),i.append("text").text(function(t){return t.name}).attr("x",o+r).attr("y",function(){return o/2+(this.clientHeight?this.clientHeight:13)/2-2})},i.x=function(t){return arguments.length?(a=t,i):a},i.y=function(t){return arguments.length?(u=t,i):u},i.gap=function(t){return arguments.length?(s=t,i):s},i.itemHeight=function(t){return arguments.length?(o=t,i):o},i},n.capped=function(e){var r=1/0,i="Others",a=function(n){var r=t.sum(n,e.valueAccessor()),a=e.group().all(),u=t.sum(a,e.valueAccessor()),o=n.map(e.keyAccessor()),s=a.map(e.keyAccessor()),l=t.set(o),c=s.filter(function(t){return!l.has(t)});n.push({others:c,key:i,value:u-r})};return e.assembleCappedData=function(){if(1/0==r)return e.computeOrderedGroups();var t=e.group().top(r);return t=e.computeOrderedGroups(t),a&&a(t),t},e.cap=function(t){return arguments.length?(r=t,e):r},e.othersLabel=function(t){return arguments.length?(i=t,e):i},e.othersGrouper=function(t){return arguments.length?(a=t,e):a},n.override(e,"onClick",function(t){t.others&&t.others.forEach(function(t){e.filter(t)}),e._onClick(t)}),e},n.numberDisplay=function(e,r){var i="number-display",a=t.format(".2s"),u=n.baseChart({});return u.dimension({}),u.value=function(){var t=u.group().all&&u.group().all()[0]||u.group().value();return u.valueAccessor()(t)},u.transitionDuration(250),u.doRender=function(){var e=u.value(),n=u.selectAll("."+i);return n.empty()&&(n=n.data([0]).enter().append("span").attr("class",i)),n.transition().duration(u.transitionDuration()).ease("quad-out-in").tween("text",function(){var n=t.interpolateNumber(this.lastValue||0,e);return this.lastValue=e,function(t){this.textContent=u.formatNumber()(n(t))}}),u},u.doRedraw=function(){return u.doRender()},u.formatNumber=function(t){return arguments.length?(a=t,u):a},u.anchor(e,r)},n}if("function"==typeof define&&define.amd)define(["d3","crossfilter"],t);else if("object"==typeof module&&module.exports){var e=require("d3"),n=require("crossfilter");"function"!=typeof n&&(n=n.crossfilter),module.exports=t(e,n)}else this.dc=t(d3,crossfilter)}();